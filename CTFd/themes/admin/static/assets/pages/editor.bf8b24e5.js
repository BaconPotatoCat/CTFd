import{$ as e,X as m,a1 as p,V as s,C as r,u,v as l}from"./main.31b27a22.js";import"../htmlmixed.5b98bf60.js";import{C as f}from"../CommentBox.05179204.js";import"../echarts.e8baadb1.js";import"../runtime-dom.esm-bundler.5d4ca5d9.js";function w(){window.editor.save();var i=e("#page-edit").serializeJSON(),o="/api/v1/pages",n="POST";let d=window.location.pathname.split("/").pop();d!=="new"&&(o+="/"+d,n="PATCH"),r.fetch(o,{method:n,credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then(function(t){return t.json()}).then(function(t){if(t.success===!1){let a="";for(const c in t.errors)a+=t.errors[c].join(`
`),a+=`
`;u({title:"Error",body:a,button:"OK"});return}n==="PATCH"&&t.success?l({title:"Saved",body:"Your changes have been saved"}):window.location=r.config.urlRoot+"/admin/pages/"+t.data.id})}function g(){window.editor.save(),e("#page-edit").attr("action",r.config.urlRoot+"/admin/pages/preview"),e("#page-edit").attr("target","_blank"),e("#page-edit").submit()}e(()=>{if(window.editor=m.fromTextArea(document.getElementById("admin-pages-editor"),{lineNumbers:!0,lineWrapping:!0,mode:"htmlmixed",htmlMode:!0}),e("#media-button").click(function(i){p(window.editor)}),e("#save-page").click(function(i){i.preventDefault(),w()}),e(".preview-page").click(function(){g()}),window.PAGE_ID){const i=s.extend(f);let o=document.createElement("div");document.querySelector("#comment-box").appendChild(o),new i({propsData:{type:"page",id:window.PAGE_ID}}).$mount(o)}});
